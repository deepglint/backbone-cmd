# 数据结构定义
---------

## 获取事件的方法

### 1.通过HTTP查询

调用tssdetailpaging API可按条件分页查询事件列表；tsscount API可获得满足条件API的个数。

### 2.通过设置HTTP服务器地址接收

通过配置客户端或API设置第三方服务器的地址，Event将以HTTP POST的形式主动发送到该地址。参见getpuburl和postpuburl两个API的文档。
<br /><br />
## 事件的数据结构

    Id            string //事件id
    UserId        int  //sensor拥有者
    PeopleId      string    //人员id
    StartTime     string/int //事件开始时间（毫秒），类型取决于时间格式的选择，具体请参见“时间格式”部分
    TimeLength    int    //事件持续时间长度（毫秒）
    AlarmLevel    int //报警级别 [0, 9] 具体请见下表
    EventType     int    //事件类型，具体请见下表
    EventTypeProbability  float   //事件类型识别概率 [0, 1]
    PlanetId      string //第一级场景的id
    SceneId       string //第二级场景的id
    SensorId      string //传感器id
    HotspotId     string //事件发生的hotspot的Id
    CutboardBox   array of int   //cutboard的[x,y,height,width]坐标
    CutboardTimeOffset   array of int    //Cutboard开始的时间和事件开始的时间（StartTime）之间的差值，是一个时间差序列，对于每个cutboard是一个多帧序列（单位：毫秒ms）
 <br /><br />      
## 事件的类型定义

事件（event）分为**有状态事件**和**无状态事件**两种。
有状态事件在实时报警中需要分段报出，并遵循如下规则：

	* 事件开始:EventType为1结尾；
	* 事件持续的心跳:EventType为2结尾，可以有多个，直到事件结束；
	* 事件结束:EventType为3结尾；
	* 合并后的完整事件:EventType为0结尾。
对于同一事件，以上三个阶段提交的PeopleId或SensorID应该相同，这取决于事件类型。

无状态事件在报警中没有开始结束的概念，直接以心跳报出，并遵循如下规则：

	* 事件发生:EventType为9结尾；
	* 合并后的完整事件:EventType为0结尾。

事件EventType的列表：

    镜头异常：100，101，102，103
    光线变暗：120，129
    光线变亮：130，139
    人员进出：220，221，222，223
    人员跌倒：310，319
    剧烈运动：320，329
    速度异常：510，511，512，513
    行程过长：540，541，542，543
    逗留过久：550，551，552，553
    人员过多：610，611，612，613
    夜间接近：630，631，632，633
    越线：   720，721，722，723
    区域入侵：730，731，732，733
    区域人数异常：740，741，742，743
    单人加钞：1000，1001，1002，1003
    
报警级别（Alarmlevel）目前的分类如下：

	AlarmLevelBasic    默认    警报对应值1
	AlarmLevelMiddle    剧烈运动、单人加钞、越线、区域入侵    警报对应值5
	AlarmLevelHigh    镜头异常    警报对应值9
<br /><br />     
## 时间格式的定义

### 1.自定义时间格式

自定义时间格式使用"特定参考时间"的方式来描述，参考时间为：

    Mon Jan 2 15:04:05 MST 2006
    
相对应的Unix time（参考[http://www.unixtimestamp.com/](http://www.unixtimestamp.com/)）为1136239445。而MST对应的时区是GMT-0700，参考时间同样可以写为:

    01/02 03:04:05PM 06-0700
    
你可以按照自己的格式写出这个参考时间，用以表达自定义的时间格式。对于秒之后的位数，如毫秒、微秒或纳秒，用小数点后的零的个数（1到9个）来表示，三个零表示毫秒，九个零表示纳秒。如：5:04:34.000

用时差的方式表示时区：

    -0700将会匹配±hhmm
    -07:00将会匹配±hh:mm
    
用符号Z来替换-号，将会简化UTC的表达方式为一个Z，如：

    Z0700将会匹配Z或±hhmm
    Z07:00将会匹配Z或±hh:mm
    
### 2.输入时间的格式

除非特别标明，在API中输入的时间进行了**自动适配**，目前兼容的为以下几种格式：

	格式：Unix Timastamp Second 
	举例：1442029104

	格式：Unix Timastamp MilliSecond
	举例：1442029104099

	格式："2006-01-02T15:04:05.000MST", 
	举例："2015-08-25T11:25:47.586UTC"

	格式："2006-01-02T15:04:05.000Z0700", 
	举例："2015-08-25T11:25:47.586+0800"

	格式："2006-01-02T15:04:05.000Z07:00", 
	举例："2015-08-25T11:25:47.586+08:00"

	格式："2006-01-02T15:04:05MST",
	举例："2015-08-25T11:25:47UTC"

	格式："2006-01-02T15:04:05Z0700",
	举例："2015-08-25T11:25:47+0800"

	格式："2006-01-02T15:04:05Z07:00",
	举例："2015-08-25T11:25:47+08:00"

### 3.输出时间的格式：

输出的时间支持上述输入的时间格式以及自定义格式。
 <br /><br />      
## HTTP CODE
	200 返回成功
	201 写入成功
	400 请求错误
	500 内部错误